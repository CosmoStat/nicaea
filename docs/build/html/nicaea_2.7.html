<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>nicaea &#8212; nicaea  documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="nicaea  documentation" href="index.html" />
    <link rel="prev" title="nicaea v2.7 documentation" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="index.html" title="nicaea v2.7 documentation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">nicaea  documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="nicaea">
<h1>nicaea<a class="headerlink" href="#nicaea" title="Permalink to this headline">¶</a></h1>
<p>NumerIcal Cosmology And lEnsing cAlculations</p>
<p>Version 2.7 (02/2017)</p>
<p>Web page: <a class="reference external" href="http://cosmostat.org/nicaea">http://cosmostat.org/nicaea</a></p>
<div class="section" id="authors">
<h2>Authors:<a class="headerlink" href="#authors" title="Permalink to this headline">¶</a></h2>
<p>Martin Kilbinger</p>
<p>Karim Benabed</p>
<p>Jean Coupon (HOD, halomodel)</p>
<p>Henry J. McCracken (HOD)</p>
<div class="section" id="contributors">
<h3>Contributors:<a class="headerlink" href="#contributors" title="Permalink to this headline">¶</a></h3>
<p>Liping Fu (decomp_eb)</p>
<p>Catherine Heymans (intrinsic alignment)</p>
</div>
<div class="section" id="documentation">
<h3>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h3>
<p>nicaea is the cosmology part of cosmo_pmc, which can be downloaded for free at
<a class="reference external" href="http://www.cosmopmc.info">http://www.cosmopmc.info</a>. From that site, the cosmo_pmc manual is available for
further information about nicaea, which are more detailed than covered in this
readme.</p>
</div>
<div class="section" id="download-compile-and-run-nicaea">
<h3>Download, compile, and run nicaea<a class="headerlink" href="#download-compile-and-run-nicaea" title="Permalink to this headline">¶</a></h3>
<div class="section" id="download-the-code">
<h4>Download the code<a class="headerlink" href="#download-the-code" title="Permalink to this headline">¶</a></h4>
<p>Download the file nicaea_2.7.tgz from <a class="reference external" href="http://cosmostat.org/nicaea">http://cosmostat.org/nicaea</a> and un-tar
the archive. The packages fftw3 and gsl are required to compile and run nicaea.
You can install fftw3 from <a class="reference external" href="http://www.fftw.org">http://www.fftw.org</a>, and gsl from
www.gnu.org/software/gsl.</p>
</div>
<div class="section" id="compile-and-install-the-code">
<h4>Compile and install the code<a class="headerlink" href="#compile-and-install-the-code" title="Permalink to this headline">¶</a></h4>
<p>Two options to compile nicaea exist. If nicaea is to be used as a library,
option 1 is recommended.</p>
<p>Option 1: using cmake, <em>recommended</em>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">build</span>
<span class="n">cmake</span> <span class="o">..</span>
<span class="n">make</span> <span class="o">&amp;&amp;</span> <span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
<p>The last command will copy the executable demo programs (e.g. lensingdemo)
to &lt;BASE&gt;/bin, the library libnicaea.a to &lt;BASE&gt;/lib, and the include
files to &lt;BASE&gt;/include/nicaea . The default base directory is
&lt;BASE&gt;=nicaea_2.7 .</p>
<p>If the necessary libraries are found on the system, the python module
pynicaea is also installed.</p>
<p>The code can be tested with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ctest</span> <span class="o">-</span><span class="n">vv</span>
</pre></div>
</div>
<p>To run the demo programs (see below), go to nicaea_2.7/par_files .</p>
<p>Option 2: using make.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">Demo</span>
<span class="n">make</span>
</pre></div>
</div>
<p>If fftw3 and gsl are not installed in a standard directory (e.g. /usr,
/usr/local), set the variables &#8216;FFTW&#8217; and &#8216;GSL&#8217; in the Makefile. The header
file fftw3.h is looked for in $(FFTW)/include and libfftw3.a in $(FFTW)/lib.
The gsl header files are looked for in $(GSL)/include, the libraries libgsl.a
and libgslcblas.a in $(GSL)/lib.</p>
<p>Various demo programs can be run in ./Demo, see below.</p>
</div>
<div class="section" id="run-the-demo-programs">
<h4>Run the demo programs<a class="headerlink" href="#run-the-demo-programs" title="Permalink to this headline">¶</a></h4>
<p>The demo programs need parameter files in the working directory, which can be
found in par_files.</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="13%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Program name</th>
<th class="head">Category</th>
<th class="head">Functionality</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>lensingdemo</td>
<td>Weak lensing</td>
<td>density- and lensing power spectrum, lensing second-order functions</td>
</tr>
<tr class="row-odd"><td>sn1demo</td>
<td>SNIa</td>
<td>Luminosity distance, distance module</td>
</tr>
<tr class="row-even"><td>halomodeldemo</td>
<td>Halo model</td>
<td>Power spectrum</td>
</tr>
<tr class="row-odd"><td>cmb_bao_demo</td>
<td>CMB, BAO</td>
<td>geometrical quantities, e.g. sound horizon, angular diameter distance</td>
</tr>
<tr class="row-even"><td>decomp_eb_demo</td>
<td>Weak lensing</td>
<td>E-/B-mode decomposition (generaalized ring statistic)</td>
</tr>
<tr class="row-odd"><td>cosebi_demo</td>
<td>Weak lensing</td>
<td>E-/B-mode decomposition (COSEBIs)</td>
</tr>
<tr class="row-even"><td>third_order_demo</td>
<td>Weak lensing</td>
<td>Third-order aperture-mass moments</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="main-functions">
<h3>Main functions<a class="headerlink" href="#main-functions" title="Permalink to this headline">¶</a></h3>
<p>The main functions listed below have as some of their parameters:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">model</span><span class="p">:</span> <span class="n">cosmo_lens</span><span class="o">*</span> <span class="n">structure</span> <span class="p">(</span><span class="n">see</span> <span class="n">Sect</span><span class="o">.</span> <span class="mi">4</span><span class="p">)</span>
     <span class="n">Lensing</span> <span class="ow">and</span> <span class="n">cosmological</span> <span class="n">paramaters</span> <span class="ow">and</span> <span class="n">pre</span><span class="o">-</span><span class="n">computed</span> <span class="n">tables</span>
<span class="n">theta</span><span class="p">,</span> <span class="n">THETA_MIN</span><span class="p">,</span> <span class="n">THETA_MAX</span><span class="p">,</span> <span class="n">Psimin</span><span class="p">,</span> <span class="n">Psimax</span><span class="p">:</span> <span class="n">double</span>
     <span class="n">Angular</span> <span class="n">scale</span> <span class="p">[</span><span class="n">rad</span><span class="p">]</span>
<span class="n">R</span><span class="p">:</span> <span class="n">double</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
     <span class="n">Array</span> <span class="n">of</span> <span class="n">angular</span> <span class="n">scale</span> <span class="n">tripes</span>
<span class="n">i_bin</span><span class="p">,</span> <span class="n">j_bin</span><span class="p">,</span> <span class="n">k_bin</span><span class="p">:</span> <span class="nb">int</span>
     <span class="n">Redshift</span> <span class="nb">bin</span> <span class="n">indices</span>
<span class="n">err</span><span class="p">:</span> <span class="n">error</span><span class="o">*</span> <span class="p">(</span><span class="n">see</span> <span class="n">Sect</span><span class="o">.</span> <span class="mi">4</span><span class="p">)</span>
     <span class="n">Error</span> <span class="n">structure</span>
<span class="n">n</span><span class="p">:</span> <span class="n">integer</span>
     <span class="n">COSEBIs</span> <span class="n">mode</span><span class="o">.</span>
<span class="n">path</span><span class="p">:</span> <span class="n">string</span>
     <span class="n">Path</span> <span class="n">to</span> <span class="n">COSEBIs</span> <span class="n">files</span> <span class="k">with</span> <span class="n">zeros</span> <span class="k">for</span> <span class="n">given</span> <span class="n">Psimin</span> <span class="ow">and</span> <span class="n">Psimax</span><span class="o">.</span> <span class="n">Default</span>
     <span class="ow">is</span> <span class="o">*/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">nicaea</span><span class="o">/</span><span class="n">par_files</span><span class="o">/</span><span class="n">COSEBIs</span><span class="o">/*.</span>
<span class="n">B_cosebi</span><span class="p">:</span> <span class="n">double</span><span class="o">*</span>
     <span class="n">On</span> <span class="n">output</span><span class="p">,</span> <span class="n">B_mode</span> <span class="ow">is</span> <span class="n">written</span> <span class="n">to</span> <span class="n">this</span> <span class="n">pointer</span> <span class="k">if</span> <span class="n">non</span> <span class="n">zero</span><span class="o">.</span>
<span class="n">aa</span><span class="p">:</span> <span class="n">array</span> <span class="n">of</span> <span class="n">doubles</span>
     <span class="n">Pre</span><span class="o">-</span><span class="n">calculated</span> <span class="n">array</span> <span class="n">of</span> <span class="n">coefficients</span><span class="p">,</span> <span class="n">see</span> <span class="n">decomp_eb</span><span class="o">.</span><span class="n">c</span><span class="o">.</span>
<span class="n">N</span><span class="p">:</span> <span class="n">integer</span>
     <span class="n">Polynomial</span> <span class="n">order</span><span class="p">,</span> <span class="n">default</span> <span class="mi">6</span>
<span class="n">poly</span><span class="p">:</span> <span class="n">poly_t</span> <span class="n">enumeration</span> <span class="nb">type</span>
     <span class="n">Polyonmial</span> <span class="nb">type</span><span class="p">,</span> <span class="n">default</span> <span class="o">*</span><span class="n">cheby2</span><span class="o">*</span>
<span class="n">wfilter</span><span class="p">:</span> <span class="n">filter_t</span> <span class="n">enumeration</span>
     <span class="n">Aperture</span><span class="o">-</span><span class="n">mass</span> <span class="nb">filter</span> <span class="nb">type</span><span class="p">,</span> <span class="n">see</span> <span class="n">lensing_3rd</span><span class="o">.</span><span class="n">h</span><span class="p">,</span> <span class="n">default</span> <span class="o">*</span><span class="n">fgauss</span><span class="o">*.</span>
<span class="n">a</span><span class="p">:</span> <span class="n">double</span>
     <span class="n">Scale</span> <span class="n">factor</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">zmax</span><span class="p">))</span><span class="o">&lt;=</span><span class="n">a</span><span class="o">&lt;</span><span class="mf">1.0</span>
<span class="n">k</span><span class="p">:</span> <span class="n">double</span>
     <span class="mi">3</span><span class="n">d</span> <span class="n">Fourier</span> <span class="n">wave</span><span class="o">-</span><span class="n">mode</span> <span class="ow">in</span> <span class="n">h</span><span class="o">/</span><span class="n">Mpc</span>
<span class="n">s</span><span class="p">:</span> <span class="n">double</span>
     <span class="mi">2</span><span class="n">d</span> <span class="n">Fourier</span> <span class="n">wave</span><span class="o">-</span><span class="n">mode</span><span class="p">,</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">2</span><span class="o">&lt;=</span><span class="n">ell</span><span class="o">&lt;=</span><span class="mi">1</span><span class="n">e6</span>
<span class="n">ell</span><span class="p">:</span> <span class="n">integer</span>
     <span class="mi">2</span><span class="n">D</span> <span class="n">harmonic</span> <span class="n">mode</span><span class="p">,</span> <span class="n">ell</span><span class="o">&gt;=</span><span class="mi">2</span>
</pre></div>
</div>
<p>The value of the corresponding two- and three-point function is returned as
double.</p>
<div class="section" id="second-order-shear-statistics">
<h4>Second-order shear statistics<a class="headerlink" href="#second-order-shear-statistics" title="Permalink to this headline">¶</a></h4>
<p>The following functions are not defined if sprojection==full.</p>
<p>Two-point correlation function xi+ (pm=0) and xi- (pm=1) at angular scale theta [rad]:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">xi</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">pm</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">i_bin</span><span class="p">,</span> <span class="n">j_bin</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
<p>Top-hat shear variance in a circle of radius theta [rad]:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">gamma2</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">i_bin</span><span class="p">,</span> <span class="n">j_bin</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
<p>Aperture-mass variance, polynomial filter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">map2_poly</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">i_bin</span><span class="p">,</span> <span class="n">j_bin</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
<p>Aperture-mass variance, Gaussian filter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">map2_gauss</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">i_bin</span><span class="p">,</span> <span class="n">j_bin</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
<p>COSEBIs (Complete Orthogonal E-/B-mode Integrals), <a class="reference internal" href="#cosebis" id="id1">[14]</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">E_cosebi</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">Psimin</span><span class="p">,</span> <span class="n">Psimax</span><span class="p">,</span> <span class="n">i_bin</span><span class="p">,</span> <span class="n">j_bin</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">B_cosebi</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
<p>&#8216;Ring&#8217; statistics, with Chebyshev-filter function decomposition, see <a class="reference internal" href="#fk10" id="id2">[6]</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">RR</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">THETA_MIN</span><span class="p">,</span> <span class="n">THETA_MAX</span><span class="p">,</span> <span class="n">aa</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">poly</span><span class="p">,</span> <span class="n">pm</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="third-order-shear-statistics">
<h4>Third-order shear statistics<a class="headerlink" href="#third-order-shear-statistics" title="Permalink to this headline">¶</a></h4>
<p>Third-order aperture-mass generalized moment, <a class="reference internal" href="#skl05" id="id3">[4]</a>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">map3</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">i_bin</span><span class="p">,</span> <span class="n">i_bin</span><span class="p">,</span> <span class="n">k_bin</span><span class="p">,</span> <span class="n">wfilter</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="power-spectra">
<h4>Power spectra<a class="headerlink" href="#power-spectra" title="Permalink to this headline">¶</a></h4>
<p>3d power spectrum of delta:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">P_NL</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
<p>2d shear power spectrum: Pshear or Pshear+Pg^(1) if reduced-shear correction is
switched on with key &#8220;sreduced = K10&#8221; in cosmo_lens.par parameter file.
Returns error if sprojection==full:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Pshear</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">i_bin</span><span class="p">,</span> <span class="n">j_bin</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
<p>2d shear power spectrum Pshear for integer ell. Computes full spherical
projection for sprojection==full (Kilbinger et al. 2017). Calls Pshear for
other cases of sprojection:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Pshear_spherical</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ell</span><span class="p">,</span> <span class="n">i_bin</span><span class="p">,</span> <span class="n">j_bin</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
<p>2d reduced-shear correction power spectrum Pg^(1), see Kilbinger (2010). The
totel (reduced-shear) power spectrum is Pkappa + Pg1:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Pg1</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">i_bin</span><span class="p">,</span> <span class="n">j_bin</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="ranges">
<h4>Ranges<a class="headerlink" href="#ranges" title="Permalink to this headline">¶</a></h4>
<p>The range for k is unlimited except for the coyote10 and coyote13 non-linear emulators.
For k&lt;3.3e-6 h/Mpc and k&gt;333 h/Mpc, the
power spectrum is extrapolated (see below). The limits can be changed
in cosmo.h.</p>
<p>The reduced-shear correction fits are accurate to 2% beetween ell=0.1 and 2*10^5. Outside
that range, Pg^(1) return zero.</p>
<p>The range for theta is very, very large, it is determined
in the routine xi_via_hankel. Although the Hankel transform is
accurate only on a much smaller interval, the range of acceptable
results is still from sub-arcseconds to a couple of degrees.</p>
<p>The limited range of the reduced-shear correction reflects in a smaller valid angular range
of xi+ and xi-. If the reduced-shear is switched on, the ranges within which the second-order
functions are affected to small fractions of a percent are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Function</th>
<th class="head">Minimum scale</th>
<th class="head">Maximum scale</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>xi+</td>
<td>0.1&#8217;</td>
<td>1000&#8217;</td>
</tr>
<tr class="row-odd"><td>xi-</td>
<td>0.5&#8217;</td>
<td>1000&#8217;</td>
</tr>
<tr class="row-even"><td>mapsqr</td>
<td>0.2&#8217;</td>
<td>1000&#8217;</td>
</tr>
<tr class="row-odd"><td>gammasqr</td>
<td>0.1&#8217;</td>
<td>1000&#8217;</td>
</tr>
<tr class="row-even"><td>mapsqr_gauss</td>
<td>0.1&#8217;</td>
<td>1000&#8217;</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="cosmology">
<h3>Cosmology<a class="headerlink" href="#cosmology" title="Permalink to this headline">¶</a></h3>
<p>The cosmology is encoded in the structure cosmo. It contains all
relevant cosmological and nuisance parameters, and pre-calculated
tables and constants. If parameters change, these tables are
recomputed once they are needed. All lensing-related variables are
contained in the structure cosmo_lens.</p>
<div class="section" id="reading-parameters-from-a-file">
<h4>Reading parameters from a file<a class="headerlink" href="#reading-parameters-from-a-file" title="Permalink to this headline">¶</a></h4>
<p>The function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">read_cosmological_parameters_lens</span><span class="p">(</span><span class="o">&amp;</span><span class="n">model</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
<p>reads cosmological and lensing parameters from the file F (type FILE*) and
initialised the structure cosmo_lens *model. The file &#8216;cosmo_lens.par&#8217; is an
example file. First, it contains a reference to the basic cosmology file &#8216;cosmo.par&#8217;,
containing cosmological parameters. Next, redshift information is read from
the file &#8216;nofz.par&#8217;. Then, the lensing parameters follow.</p>
</div>
<div class="section" id="initializing-the-cosmology">
<h4>Initializing the cosmology<a class="headerlink" href="#initializing-the-cosmology" title="Permalink to this headline">¶</a></h4>
<p>The function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">init_parameters_lens</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>returns a pointer to the structure cosmo_lens with parameters given by
the arguments and blank tables. If passed to a function (e.g. one
described in Sect.2), the corresponding tables and constants (if
required) are filled and calculated. Successive calls to this function
will be very fast since only a linear interpolation of the tabulated
values is performed.</p>
</div>
<div class="section" id="changing-the-cosmology">
<h4>Changing the cosmology<a class="headerlink" href="#changing-the-cosmology" title="Permalink to this headline">¶</a></h4>
<p>If a different cosmology is required, a new cosmo_lens pointer has to be
created, either with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">model_new</span> <span class="o">=</span> <span class="n">init_parameters_lens</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>as above, or with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">model_new</span>         <span class="o">=</span> <span class="n">copy_parameters_lens_only</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span><span class="o">.</span>
<span class="n">model_new</span><span class="o">-&gt;</span><span class="n">param1</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">model_new</span><span class="o">-&gt;</span><span class="n">param2</span> <span class="o">=</span> <span class="o">...</span>
<span class="o">...</span>
</pre></div>
</div>
<p>In both cases, all tables and constants are blanked. A call of:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">updateFrom_lens</span><span class="p">(</span><span class="n">model_new</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
</pre></div>
</div>
<p>copies tables from model to model_new if corresponding parameters are
unchanged and leaves those blank which have to be recalculated if
required. This is particularly efficient if only a few or only &#8220;fast&#8221;
parameters change since a small number of (time-consuming) functions
will be recalculated. E.g., if only the redshift parameters change,
the non-linear power spectra and growth factor need not be
recalculated, only the shear statistics, which is very fast due to the
Hankel transform.</p>
</div>
<div class="section" id="parameters-and-ranges">
<h4>Parameters and ranges<a class="headerlink" href="#parameters-and-ranges" title="Permalink to this headline">¶</a></h4>
<p>The following parameters are implemented. Within a given range, the
program should obtain reasonable results or return an error message (see
Sect.4). The program does not check whether a parameter is within its
range. The following ranges have been tested some time ago, probably the code
will work outside of these ranges as well.</p>
</div>
<div class="section" id="id4">
<h4>Cosmology<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="59%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Parameter</th>
<th class="head">Description</th>
<th class="head">Minimum</th>
<th class="head">Maximum</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Omega_m</td>
<td>total matter density (baryonic + dark)</td>
<td>0.1</td>
<td>1.5</td>
</tr>
<tr class="row-odd"><td>Omega_de</td>
<td>dark energy density</td>
<td>0.1</td>
<td>1.5</td>
</tr>
<tr class="row-even"><td>w0_de</td>
<td>dark energy eos parametrization (see below)</td>
<td>-2.0</td>
<td>-0.5</td>
</tr>
<tr class="row-odd"><td>w1_de</td>
<td>dark energy eos parametrization (see below)</td>
<td>-0.6</td>
<td>0.6</td>
</tr>
<tr class="row-even"><td>h_100</td>
<td>Hubble parameter H_0 = 100 h_100 km/s/Mpc</td>
<td>0.4</td>
<td>1.0</td>
</tr>
<tr class="row-odd"><td>Omega_b</td>
<td>baryon density</td>
<td>0.02</td>
<td>0.06</td>
</tr>
<tr class="row-even"><td>Omega_nu_mass</td>
<td>massive neutrino density</td>
<td colspan="2">(not tested)</td>
</tr>
<tr class="row-odd"><td>N_eff_mass</td>
<td>Number of massive neutrinos</td>
<td colspan="2">(not tested)</td>
</tr>
<tr class="row-even"><td>sigma_8</td>
<td>Late-time power spectrum normalisation</td>
<td>0.1</td>
<td>1.5</td>
</tr>
<tr class="row-odd"><td>A_s</td>
<td>CMB power spectrum normalization</td>
<td colspan="2">(not tested)</td>
</tr>
<tr class="row-even"><td>n_spec</td>
<td>primordial spectral index</td>
<td>0.7</td>
<td>1.3</td>
</tr>
</tbody>
</table>
<p>The power spectrum normalisation can be chosen with the flag normmode = 0 for sigma_8
and 1 for A_s.</p>
</div>
<div class="section" id="redshift-parameters">
<h4>Redshift parameters<a class="headerlink" href="#redshift-parameters" title="Permalink to this headline">¶</a></h4>
<p>The number of redshift bins is Nzbin. For each bin n_bin, the number of
redshift parameters is given by Nnz[n_bin], its base type by nofz[n_bin].
The photometric redshift error type is photz[n_bin].
The sub-array par_nz[n_bin*Nn_max .. n_bin*Nnz_max+Nnz[n_bin]] contains the
Nnz[n_bin] redshift parameters of bin n_bin. For all types the first two
parameters define the minimum and maximum redshift: par_nz[n_bin*Nn_max]
= zmin par_nz[n_bin*Nn_max+1] = zmax. The number of parameters is the sum
of base type <em>Nnz_base</em> and photometric redshift error type parameters <em>Nnz_photz</em>.</p>
<p>The number of galaxies at redshift z from bin i is given by</p>
<p><img class="math" src="_images/math/580f203333a79fe9429e2574b8da01a99b87e445.png" alt="n_i(z) \propto \int\limits_{z_{{\rm p}, i}}^{z_{{\rm p}, i+1}} {\rm d} z p(z, z_{\rm p}) n(z)"/></p>
<p>and the distribution for each bin is normalized to unity.</p>
<p>The following base types exist:</p>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="7%" />
<col width="15%" />
<col width="29%" />
<col width="42%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">nofz</th>
<th class="head">Nnz_base</th>
<th class="head">parameters</th>
<th class="head">symbols</th>
<th class="head">n(z) (for zmin&lt;z&lt;zmax)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>ludo</td>
<td>5</td>
<td>alpha_p, beta_p, z0</td>
<td><img class="math" src="_images/math/4f12e65686adbcbfa660db11951392f386762a63.png" alt="\alpha_p, \beta_p, z_0"/></td>
<td><img class="math" src="_images/math/dd2977c33f963d2bca58317c343594c243e1de6d.png" alt="(z/z_0)^{\alpha_p} \exp[-(z/z_0)^{\beta_p}]"/></td>
</tr>
<tr class="row-odd"><td>jonben</td>
<td>5</td>
<td>a, b, c</td>
<td><img class="math" src="_images/math/c7e4c2a0fbcd808934577aa955152c301248e945.png" alt="a, b, c"/></td>
<td><img class="math" src="_images/math/13cefd2057c9d6f28eb3962dc69eb3e35e49bed2.png" alt="z^a/(z^b + c)"/></td>
</tr>
<tr class="row-even"><td>ymmk</td>
<td>5</td>
<td>a, b, c</td>
<td><img class="math" src="_images/math/c7e4c2a0fbcd808934577aa955152c301248e945.png" alt="a, b, c"/></td>
<td><img class="math" src="_images/math/0e7dd8bfa23b32a0fb4469c987911fc894da1dd4.png" alt="(z^a + z^{ab})/(z^b + c)"/></td>
</tr>
<tr class="row-odd"><td>cfhtlens</td>
<td>7</td>
<td>z1, z2, ac, b, d</td>
<td><img class="math" src="_images/math/23e4db32f6a583fb2f90ca6e3a7fe525c29e7148.png" alt="z_1, z_2, a/c, b, d"/></td>
<td><img class="math" src="_images/math/d764aff2248352506b0a8ecacbccbf45c0e6dfbd.png" alt="a/c * \exp(-((z-z_1)/b)^2) + \exp(-((z-z_2)/d)^2)"/></td>
</tr>
<tr class="row-even"><td>single</td>
<td>2</td>
<td>z0</td>
<td><img class="math" src="_images/math/021544f44170a0f49c908e326ff0f1e031e7089c.png" alt="z_0"/></td>
<td><img class="math" src="_images/math/8920dd22a836f56eba14dc095fb398e24102b915.png" alt="\delta_{\rm D}(z - z0)"/></td>
</tr>
<tr class="row-odd"><td>hist</td>
<td>2n+1</td>
<td>zi, Ni</td>
<td><img class="math" src="_images/math/3316592029954c57a9e3b76910cb738a0542a60e.png" alt="z_0\ldots z_n,N_0\ldots N_{n-1}"/></td>
<td>Histogram with n bins of values <img class="math" src="_images/math/46832e8eff2171864496bed218daacc3b7ce0afa.png" alt="N_i"/> and corners
<img class="math" src="_images/math/6de62736d8aa90101801d7a1416e97e921d1620f.png" alt="z_i"/></td>
</tr>
</tbody>
</table>
<p>type=hist assumes a N(z) histogram with n bins.</p>
<p>The following photometric redshift error types exist:</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="8%" />
<col width="18%" />
<col width="24%" />
<col width="41%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">photz</th>
<th class="head">Nnz_photz</th>
<th class="head">parameters</th>
<th class="head">symbols</th>
<th class="head">p(z, z_p)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>photz_no</td>
<td>0</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td><ul class="first last simple">
<li></li>
</ul>
</td>
<td><img class="math" src="_images/math/f63095e95dd5e53a66e2f4fc92fea81d68adca47.png" alt="\delta_{\rm D}(z - z_{\rm p})"/></td>
</tr>
<tr class="row-odd"><td>photz_gauss</td>
<td>7</td>
<td>sigma_z, z_bias, c_cal,
f_out, sigma_z_out,
z_bias_out, c_cal_out</td>
<td><img class="math" src="_images/math/5cbf2e7d44c6feeebff15401493673b14da26fd0.png" alt="\sigma_z, z_{\rm b},
c_{\rm cal}, f_{\rm out},
\sigma_{z, {\rm out}}, z_{\rm
b, out}, c_{\rm cal, out}"/></td>
<td><img class="math" src="_images/math/fdb23b40743eef0261792ea57399700df09e7c55.png" alt="(1 - f_{\rm out}) {\cal N}(z, c_{\rm cal} z_{\rm
p} - z_{\rm b}, \sigma_z (1 + z_{\rm p})) + f_{\rm out}
{\cal N}(z c_{\rm cal, out} z_{\rm p} - z_{\rm b, out},
\sigma_{z, {\rm out}} (1 + z_{\rm p}))"/></td>
</tr>
</tbody>
</table>
<p><img class="math" src="_images/math/74e81e5f7c9a92bbb83ae40e66c4ffa146a6b3c5.png" alt="{\cal N}(\mu, \sigma)"/> is a Gaussian with mean <img class="math" src="_images/math/d79e8a2c7ce54906c2b25549da38bdbe02cf40d6.png" alt="\mu"/> and variance <img class="math" src="_images/math/011e5790a6c33043ceadca81d9657dde6c61d769.png" alt="\sigma"/>.</p>
<p>The parameters are stored in the vector par_nz as follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="11%" />
<col width="4%" />
<col width="14%" />
<col width="11%" />
<col width="11%" />
<col width="4%" />
<col width="15%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>0</td>
<td>1</td>
<td>2</td>
<td>3</td>
<td>...</td>
<td>n</td>
<td>n+1</td>
<td>n+2</td>
<td>...</td>
<td>2n</td>
</tr>
<tr class="row-even"><td><img class="math" src="_images/math/021544f44170a0f49c908e326ff0f1e031e7089c.png" alt="z_0"/></td>
<td><img class="math" src="_images/math/8465706f342b4d588b4e6712f85c9a447d0cad01.png" alt="z_n"/></td>
<td><img class="math" src="_images/math/5d3a7b3e9c3094a633b6774f0fc189524faad610.png" alt="z_1"/></td>
<td><img class="math" src="_images/math/6588308cf1730d73dec9fdb3be19c496298ed74e.png" alt="z_2"/></td>
<td>...</td>
<td><img class="math" src="_images/math/cf5e71ea40507e75192469aa6fbf833e3d29e831.png" alt="z_{n-1}"/></td>
<td><img class="math" src="_images/math/5d2483db4defbda77d5edb54e62c7eb768c7c25a.png" alt="N_0"/></td>
<td><img class="math" src="_images/math/13c592eed12d9c039b5772c54f6daf3d3d5dd51f.png" alt="N_1"/></td>
<td>...</td>
<td><img class="math" src="_images/math/ef05fed99384da056c34eca7ed9cb3e423a6173d.png" alt="N_{n-1}"/></td>
</tr>
</tbody>
</table>
<p>The number of parameters is <img class="math" src="_images/math/229a61312476056d6096ffe202f3b7b24499cb9d.png" alt="N_{n_z} = 2 n + 1"/>. The redshifts
<img class="math" src="_images/math/6de62736d8aa90101801d7a1416e97e921d1620f.png" alt="z_i"/> are understood as the lower bin boundaries with the exception of
<img class="math" src="_images/math/4c7b8b09f585cf1dd37c9eda45d671249168caab.png" alt="z_n = z_{\rm max}"/> which is the limiting redshift. The i-th bin
therefore is between <img class="math" src="_images/math/6de62736d8aa90101801d7a1416e97e921d1620f.png" alt="z_i"/> and <img class="math" src="_images/math/559bf1d43b0467eb5d22593e971ea433b1e2bff2.png" alt="z_{i+1}"/>, the (unnormalized) number
of galaxies is <img class="math" src="_images/math/46832e8eff2171864496bed218daacc3b7ce0afa.png" alt="N_i"/>. <img class="math" src="_images/math/902276b6af63725a6693c7dc469771a7f047bff2.png" alt="z_{\rm min} = z_0"/> and <img class="math" src="_images/math/65aa3fb85c48168668f722f4c39a0902467fb752.png" alt="z_{\rm max} =
z_n"/> are in the first two entries, as required.</p>
<p>A general nofz file (except hist and single, see below) has a one-line header with the base type nofz,
and optional the photometric redshift error type photz. This is followed by Nnz_base lines with the
nofz parameter values, one in each line, followed by the Nnz_photz parameters if any:</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"># nofz [photz]</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>p_0</td>
</tr>
<tr class="row-odd"><td>p_1</td>
</tr>
<tr class="row-even"><td>...</td>
</tr>
<tr class="row-odd"><td>[p_{Nnz_base-1}</td>
</tr>
<tr class="row-even"><td>q_0</td>
</tr>
<tr class="row-odd"><td>...</td>
</tr>
<tr class="row-even"><td>q_{Nnz_photz-1}]</td>
</tr>
</tbody>
</table>
<p>For the nofz types <em>hist</em> and <em>single</em>, photometric redshift errors cannot be
defined.</p>
<div class="section" id="nofz-hist">
<h5>nofz=hist<a class="headerlink" href="#nofz-hist" title="Permalink to this headline">¶</a></h5>
<p>The function read_par_nz_hist reads the histogram data from a file,
sets Nnz and returns par_nz. The file has to have the following structure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td># hist</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><img class="math" src="_images/math/021544f44170a0f49c908e326ff0f1e031e7089c.png" alt="z_0"/></td>
<td><img class="math" src="_images/math/5d2483db4defbda77d5edb54e62c7eb768c7c25a.png" alt="N_0"/></td>
</tr>
<tr class="row-odd"><td><img class="math" src="_images/math/5d3a7b3e9c3094a633b6774f0fc189524faad610.png" alt="z_1"/></td>
<td><img class="math" src="_images/math/13c592eed12d9c039b5772c54f6daf3d3d5dd51f.png" alt="N_1"/></td>
</tr>
<tr class="row-even"><td>...</td>
<td>...</td>
</tr>
<tr class="row-odd"><td><img class="math" src="_images/math/cf5e71ea40507e75192469aa6fbf833e3d29e831.png" alt="z_{n-1}"/></td>
<td><img class="math" src="_images/math/ef05fed99384da056c34eca7ed9cb3e423a6173d.png" alt="N_{n-1}"/></td>
</tr>
<tr class="row-even"><td><img class="math" src="_images/math/8465706f342b4d588b4e6712f85c9a447d0cad01.png" alt="z_n"/></td>
<td>0.0</td>
</tr>
</tbody>
</table>
<p>The last redshift value <img class="math" src="_images/math/8465706f342b4d588b4e6712f85c9a447d0cad01.png" alt="z_n"/> is the right corner of the highest redshift bin, and the corresponding
number of galaxies if necessarily 0.</p>
</div>
<div class="section" id="nofz-single">
<h5>nofz=single<a class="headerlink" href="#nofz-single" title="Permalink to this headline">¶</a></h5>
<p>All galaxies are at a single redshift z0 can achieved with the following file:</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td># single</td>
</tr>
<tr class="row-even"><td>z0</td>
</tr>
<tr class="row-odd"><td>z0</td>
</tr>
</tbody>
</table>
<p>(The value z0 has to appear twice. It is both zmin and zmax.)</p>
<p>The normalization for all types, int_zmin^zmax prob(z) dz = 1, is calculated in
the code.</p>
</div>
</div>
<div class="section" id="flags">
<h4>Flags<a class="headerlink" href="#flags" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="17%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">key</th>
<th class="head">value</th>
<th class="head">reference</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>nonlinear</td>
<td>linear</td>
<td>Linear power spectrum (<a class="reference internal" href="#bbks86" id="id5">[1]</a> CDM transfer function)</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>pd96</td>
<td><a class="reference internal" href="#pd96" id="id6">[3]</a> fitting formula</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>smith03</td>
<td>Smith et al. (2003) halofit, <a class="reference internal" href="#mnras-341-1311s" id="id7">[15]</a></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>smith03_de</td>
<td>Smith et al. (2003) halofit + dark-energy correction from icosmo.org</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>smith03_revised</td>
<td>Takahashi et al. (2012), revised halofit parameters,
<a class="reference internal" href="#apj-761-152t" id="id8">[16]</a></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>coyote10</td>
<td>Coyote emulator v1, <a class="reference internal" href="#coyotei" id="id9">[9]</a>, <a class="reference internal" href="#coyoteii" id="id10">[7]</a>, <a class="reference internal" href="#coyoteiii" id="id11">[12]</a></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>coyote13</td>
<td>Coyote emulator v2, <a class="reference internal" href="#arxiv1304-7849h" id="id12">[8]</a></td>
</tr>
<tr class="row-odd"><td>transfer</td>
<td>bbks</td>
<td>Bardeen et al. (1986) transfer function, <a class="reference internal" href="#bbks86" id="id13">[1]</a></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>eisenhu</td>
<td>Eisenstein &amp; Hu (1998) &#8220;shape fit&#8221;, <a class="reference internal" href="#apj-496-605e" id="id14">[5]</a></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>camb</td>
<td>Using camb for T(k) (not yet supported)</td>
</tr>
<tr class="row-even"><td>growth</td>
<td>heath</td>
<td>Heath (1977) analytical expression for linear growth factor (valid only
for no or a pure cosmological constant, i.e. w0_de=-1, w1_de=0)</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>growth_de</td>
<td>General dark energy model</td>
</tr>
<tr class="row-even"><td>de_param</td>
<td>jassal</td>
<td><img class="math" src="_images/math/deb5e8eff20c59238fbd647f3585cf2985384a4a.png" alt="w(a) = w_{0, {\rm de}} + w_{1, {\rm de}} a (1-a)"/></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>linder</td>
<td><img class="math" src="_images/math/955c1a69ec7e676f7a7986965a86ca98cf2c2e27.png" alt="w(a) = w_{0, {\rm de}} + w_{1, {\rm de}} (1-a)"/></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>earlyDE</td>
<td><img class="math" src="_images/math/3eb4635aa2cdedba647b1119d297da3652fafc2f.png" alt="w(a) = w_{0, {\rm de}} / \sqrt{ 1 - b_{\rm early} \log a}"/></td>
</tr>
<tr class="row-odd"><td>normmode</td>
<td>0</td>
<td>normalization = <img class="math" src="_images/math/f32e6db971de0dfc4f1885de401c9470e8737102.png" alt="\sigma_8"/></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>1</td>
<td>normalization = <img class="math" src="_images/math/807b631f4fc4575a03ad827f5b0207ff2e516388.png" alt="A_{\rm S}"/></td>
</tr>
<tr class="row-odd"><td>tomo</td>
<td>tomo_all</td>
<td>All redshift-correlations (ij), i&lt;=j</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>tomo_auto_only</td>
<td>Only autos-correlations (ii)</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>tomo_cross_only</td>
<td>Only cross-correlations (i!=j)</td>
</tr>
<tr class="row-even"><td>sprojection</td>
<td>limber</td>
<td>Standard 1st-order flat-sky Limber approximation, L1Fl</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>limber_la08</td>
<td><em>Depreciated</em>: Extended 1st-order flat-sky Limber, ExtL1Fl,
<a class="reference internal" href="#phrvd-78l3506l" id="id15">[13]</a></td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>limber_la08_hyb</td>
<td>Extended 1st-order flat-sky hybrid Limber, ExtL1FlHyb</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>limber_la08_sph</td>
<td>Extended 1st-order spherical Limber, best 1st-order approx., ExtL1Sph</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>limber2_la08</td>
<td><em>Depreciated</em>: Extended 2nd-order flat-sky Limber, ExtL2Fl</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>limber2_la08_hyb</td>
<td>Extended 2nd-order flat-sky Limber hybrid, ExtL2FlHyb</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>limber2_la08_sph</td>
<td>Extended 2nd-order spherical Limber, best approx., ExtL2Sph, <a class="reference internal" href="#kh17" id="id16">[2]</a></td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>full</td>
<td>Full spherical projection, slow, not for real-space functions</td>
</tr>
<tr class="row-even"><td>reduced</td>
<td>none</td>
<td>No reduced-shear correction</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>K10</td>
<td>Reduced-shear according to <a class="reference internal" href="#k10" id="id17">[11]</a></td>
</tr>
<tr class="row-even"><td>q_mag_size</td>
<td>double</td>
<td>If reduced==K10: q_mag_size = 2*(alpha+beta-1), see K10 eq. 16. Set
q_mag_size = 0 if no magnification/size bias correction to be added
(reduced-shear only).</td>
</tr>
<tr class="row-odd"><td>sia</td>
<td>none</td>
<td>No intrinsic alignment (IA)</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>HS04</td>
<td>Hirata &amp; Seljak linear IA model, <a class="reference internal" href="#phrvd-70f3526h" id="id18">[10]</a></td>
</tr>
<tr class="row-odd"><td>sia_terns</td>
<td>none</td>
<td>No IA</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>GI_II</td>
<td>If sia!=none: add GI and II (standard IA)</td>
</tr>
<tr class="row-odd"><td>&nbsp;</td>
<td>only_GI</td>
<td>If sia!=none: only add GI</td>
</tr>
<tr class="row-even"><td>&nbsp;</td>
<td>only_II</td>
<td>If sia!=none: only add II</td>
</tr>
<tr class="row-odd"><td>A_ia</td>
<td>double</td>
<td>If sia!=none: Global amplitude of IA contribution.</td>
</tr>
</tbody>
</table>
<p>The range for w0_de and w1_de correspond to de_param=linder.</p>
<p>The minimum scale factor a_min (used for various integrations) is set using
the function set_amin().</p>
</div>
</div>
<div class="section" id="errors-and-diagnostics">
<h3>Errors and diagnostics<a class="headerlink" href="#errors-and-diagnostics" title="Permalink to this headline">¶</a></h3>
<p>Most of the situations where an error or undefined value occurs are
intercepted by the program. In that case, a variable *err of type error* is
set via the macros:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">err</span> <span class="o">=</span> <span class="n">addError</span><span class="p">(</span><span class="n">error_type</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">err</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">)</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">err</span> <span class="o">=</span> <span class="n">addErrorVA</span><span class="p">(</span><span class="n">error_type</span><span class="p">,</span> <span class="s2">&quot;formatted message&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">err</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">,</span> <span class="n">VA_LIST</span><span class="p">)</span>
</pre></div>
</div>
<p>storing the line in the code, a message and the error type
(ce_xyz). With:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">testErrorRet</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">error_type</span><span class="p">,</span> <span class="s2">&quot;message&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">err</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">,</span> <span class="n">return_value</span><span class="p">)</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">testErrorRetVA</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">error_type</span><span class="p">,</span> <span class="s2">&quot;formatted message&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">err</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">,</span> <span class="n">return_value</span><span class="p">,</span> <span class="n">VA_LIST</span><span class="p">)</span>
</pre></div>
</div>
<p>a conditional error is produced if the (Boolean) expression test is
true. The error can be transported up the stack to the calling
function with the macro:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">forwardError</span><span class="p">(</span><span class="o">*</span><span class="n">err</span><span class="p">,</span> <span class="n">__LINE__</span><span class="p">,</span> <span class="n">return_value</span><span class="p">)</span>
</pre></div>
</div>
<p>(in case of a void function omit <em>return_value</em> but keep the comma before the
closing bracket). This can be used as diagnostics even for errors deep in the
hierarchy of functions. To exit on an error, use:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">exitOnError</span><span class="p">(</span><span class="o">*</span><span class="n">err</span><span class="p">,</span> <span class="n">FILE</span><span class="p">)</span>
</pre></div>
</div>
<p>At the start of the program, or after an error had occurred but one wishes
to continue, maybe with a different cosmology, set:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">*</span><span class="n">err</span> <span class="o">=</span> <span class="n">NULL</span>
</pre></div>
</div>
<p>An error can be caused by undefined values, not initialized parameters,
function arguments outside the valid range. Further, a specific cosmology may
not allow certain functions to be carried out. For example, in a loitering
Universe there is a maximum redshift, and if the redshift distribution extends
over this maximum, the angular diameter distance is undefined and an error is
produced.</p>
</div>
<div class="section" id="extrapolation">
<h3>Extrapolation<a class="headerlink" href="#extrapolation" title="Permalink to this headline">¶</a></h3>
<p>In the highly non-linear regime, the power spectrum is extrapolated. For the
linear power spectrum, <img class="math" src="_images/math/9b54edaa35a4428a58775665b368c819079878cf.png" alt="P(k) \propto k^{n_{\rm s}-4.0}"/> is assumed. In
the PD96-case, the stable clustering result <img class="math" src="_images/math/847a48dd731c51501fd2295cdf660ab9c67d416c.png" alt="P(k) \propto k^{-2.5}"/> is
used. For halofit, the asymptotic form of the halofit formula is taken, see
Rob&#8217;s paper eq. (61).</p>
<p>In the linear regime at small k, the extrapolation is <img class="math" src="_images/math/cab84adcea78a34b65ff6dab3bae70a3b294317b.png" alt="P(k) \propto k^n_{\rm s}"/>.</p>
</div>
<div class="section" id="performance">
<h3>Performance<a class="headerlink" href="#performance" title="Permalink to this headline">¶</a></h3>
<p>Time-consuming functions store tabulated values and interpolated when
called after the first time. The tables are recalculated when
cosmological parameters have changed since the previous call. The
correlation functions are calculated using a fast Hankel transform.</p>
</div>
<div class="section" id="known-bugs-and-shortcomings">
<h3>Known bugs and shortcomings<a class="headerlink" href="#known-bugs-and-shortcomings" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Some parameter combinations cause undefined behaviour of the
program. These are (hopefully) intercepted and an error is created
(see Sect. 5). E.g., for n_spec&lt;0.7, f_NL (Peacock&amp;Dodds) is not
defined. For a closed Universe, the probed redshift can be larger
than the maximum redshift.</li>
<li>a=1.0 very rarely creates an error, use 0.99999... instead.</li>
<li>The code is not well suited for Fisher matrix calculations. In particular
for the inverse Fisher matrix, numerical derivatives have to be very
accurate, and the interpolations between tabulated values (linear and
spline) in nicaea introduce numerical noise that can render the Fisher
matrix numerically singular (Wolz et al. 2012).</li>
<li>Dark-energy models, in particular with varying w(z), are not recommended
for the non_linear models smith03, and smith03_de. Instead, use the
revised halofit model with smith03_revised.</li>
</ul>
<p>In case of problems please don&#8217;t hesitate to contact me at
<a class="reference external" href="mailto:martin&#46;kilbinger&#37;&#52;&#48;cea&#46;fr">martin<span>&#46;</span>kilbinger<span>&#64;</span>cea<span>&#46;</span>fr</a> . Questions and comments are welcome!</p>
</div>
<div class="section" id="changes-compared-to-the-rob-smith-s-original-halofit">
<h3>Changes compared to the Rob Smith&#8217;s original halofit<a class="headerlink" href="#changes-compared-to-the-rob-smith-s-original-halofit" title="Permalink to this headline">¶</a></h3>
<p>Parts of the program &#8216;cosmo.c&#8217; is based on Rob Smiths&#8217; halofit (Smith et al.
2003). The code for determining the non-linear power spectrum has been improved
and made more efficient. The main changes are listed below. The code also
includes the non-linear fitting formulae of Peacock &amp; Dodds (1996).</p>
<ul class="simple">
<li>Tabulation of the linear and non-linear power spectrum, constants
are calculated only once.</li>
<li>Integration cutoff for determination of non-linear scale knl
flexible, as function of smoothing scale rmid; using Romberg
integration.</li>
<li>Bisection to find knl is iterative: if the bisection gets stuck at one
end of the bisecting interval, the interval is shifted accordingly and
a new bisection is started. If knl is larger than knlstern (I chose
10^6 h/Mpc), the bisection is canceled and the linear power spectrum
is used.</li>
<li>Slope and curvature are calculated only once, after knl is fixed.</li>
<li>The Eisenstein&amp;Hu (1998) fit for the transfer function is used
instead of Bond&amp;Efstathiou (1984).</li>
<li>The exact linear growth factor is used instead of the CPT92 fitting
formula. Dark energy models are incorporated.</li>
</ul>
</div>
<div class="section" id="acknowledgements">
<h3>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permalink to this headline">¶</a></h3>
<p>We thank Alexandre Boucaud, Jan Hartlap, Alina Kiessling, Jasmin Pielorz, Peter
Schneider, Rob E. Smith, Patrick Simon, Masahiro Takada, and Melody Wolk for
helpful suggestions.</p>
</div>
<div class="section" id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h3>
<p id="bibtex-bibliography-nicaea_2.7-0"><table class="docutils citation" frame="void" id="bbks86" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id5">1</a>, <a class="fn-backref" href="#id13">2</a>)</em> J.&nbsp;M. Bardeen, J.&nbsp;R. Bond, N.&nbsp;Kaiser, and A.&nbsp;S. Szalay. The statistics of peaks of gaussian random fields. <em>\apj </em>, 304:15–61, 1986.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="kh17" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id16">[2]</a></td><td>M.&nbsp;Kilbinger and others. Precision calculations of the cosmic shear power spectrum. <em>submitted to \mnras </em>, 2017. <a class="reference external" href="https://arxiv.org/abs/arXiv:XXXX.XXXX">arXiv:arXiv:XXXX.XXXX</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="pd96" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[3]</a></td><td>J.&nbsp;A. Peacock and S.&nbsp;J. Dodds. Nonlinear evolution of cosmological power spectra. <em>\mnras </em>, 280:L19, 1996.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="skl05" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[4]</a></td><td>P.&nbsp;Schneider, M.&nbsp;Kilbinger, and M.&nbsp;Lombardi. The three-point correlation function of cosmic shear. II: relation to the bispectrum of the projected mass density and generalized third-order aperture mass. <em>\aap </em>, 431:9–25, 2005. <a class="reference external" href="https://arxiv.org/abs/astro-ph/0308328">arXiv:astro-ph/0308328</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="apj-496-605e" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id14">[5]</a></td><td>D.&nbsp;J. Eisenstein and W.&nbsp;Hu. Baryonic Features in the Matter Transfer Function. <em>\apj </em>, 496:605, March 1998. <a class="reference external" href="http://cdsads.u-strasbg.fr/cgi-bin/nph-bib_query?bibcode=1998ApJ...496..605E&amp;db_key=AST">ads link</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="fk10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[6]</a></td><td>L.&nbsp;Fu and M.&nbsp;Kilbinger. A new cosmic shear function: Optimised E-/B-mode decomposition on a finite interval. <em>\mnras </em>, 401:1264–1274, 2010. <a class="reference external" href="http://adsabs.harvard.edu/abs/2009arXiv0907.0795F">ads link</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="coyoteii" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10">[7]</a></td><td>K.&nbsp;Heitmann, D.&nbsp;Higdon, M.&nbsp;White, S.&nbsp;Habib, B.&nbsp;J. Williams, E.&nbsp;Lawrence, and C.&nbsp;Wagner. The Coyote Universe. II. Cosmological Models and Precision Emulation of the Nonlinear Matter Power Spectrum. <em>\apj </em>, 705:156–174, November 2009. <a class="reference external" href="http://adsabs.harvard.edu/abs/2009ApJ...705..156H">ads link</a>, <a class="reference external" href="https://arxiv.org/abs/0902.0429">arXiv:0902.0429</a>, <a class="reference external" href="https://doi.org/10.1088/0004-637X/705/1/156">doi:10.1088/0004-637X/705/1/156</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="arxiv1304-7849h" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id12">[8]</a></td><td>K.&nbsp;Heitmann, E.&nbsp;Lawrence, J.&nbsp;Kwan, S.&nbsp;Habib, and D.&nbsp;Higdon. The Coyote Universe Extended: Precision Emulation of the Matter Power Spectrum. <em>\apj </em>, 780:111, January 2014. <a class="reference external" href="http://cdsads.u-strasbg.fr/abs/2014ApJ...780..111H">ads link</a>, <a class="reference external" href="https://arxiv.org/abs/1304.7849">arXiv:1304.7849</a>, <a class="reference external" href="https://doi.org/10.1088/0004-637X/780/1/111">doi:10.1088/0004-637X/780/1/111</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="coyotei" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[9]</a></td><td>K.&nbsp;Heitmann, M.&nbsp;White, C.&nbsp;Wagner, S.&nbsp;Habib, and D.&nbsp;Higdon. The Coyote Universe. I. Precision Determination of the Nonlinear Matter Power Spectrum. <em>\apj </em>, 715:104–121, 2010. <a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJ...715..104H">ads link</a>, <a class="reference external" href="https://arxiv.org/abs/0812.1052">arXiv:0812.1052</a>, <a class="reference external" href="https://doi.org/10.1088/0004-637X/715/1/104">doi:10.1088/0004-637X/715/1/104</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="phrvd-70f3526h" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id18">[10]</a></td><td>C.&nbsp;M. Hirata and U.&nbsp;Seljak. Intrinsic alignment-lensing interference as a contaminant of cosmic shear. <em>\prd </em>, 70(6):063526–+, September 2004. <a class="reference external" href="http://cdsads.u-strasbg.fr/cgi-bin/nph-bib_query?bibcode=2004PhRvD..70f3526H&amp;db_key=AST">ads link</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="k10" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id17">[11]</a></td><td>M.&nbsp;Kilbinger. Fitting formulae of the reduced-shear power spectrum for weak lensing. <em>\aap </em>, 519:A19+, 2010. <a class="reference external" href="http://adsabs.harvard.edu/abs/2010A">ads link</a>, <a class="reference external" href="https://arxiv.org/abs/1004.3493">arXiv:1004.3493</a>, <a class="reference external" href="https://doi.org/10.1051/0004-6361/201014829">doi:10.1051/0004-6361/201014829</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="coyoteiii" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id11">[12]</a></td><td>E.&nbsp;Lawrence, K.&nbsp;Heitmann, M.&nbsp;White, D.&nbsp;Higdon, C.&nbsp;Wagner, S.&nbsp;Habib, and B.&nbsp;Williams. The Coyote Universe. III. Simulation Suite and Precision Emulator for the Nonlinear Matter Power Spectrum. <em>\apj </em>, 713:1322–1331, April 2010. <a class="reference external" href="http://adsabs.harvard.edu/abs/2010ApJ...713.1322L">ads link</a>, <a class="reference external" href="https://arxiv.org/abs/0912.4490">arXiv:0912.4490</a>, <a class="reference external" href="https://doi.org/10.1088/0004-637X/713/2/1322">doi:10.1088/0004-637X/713/2/1322</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="phrvd-78l3506l" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id15">[13]</a></td><td>M.&nbsp;LoVerde and N.&nbsp;Afshordi. Extended Limber approximation. <em>\prd </em>, 78(12):123506, December 2008. <a class="reference external" href="http://adsabs.harvard.edu/abs/2008PhRvD..78l3506L">ads link</a>, <a class="reference external" href="https://arxiv.org/abs/0809.5112">arXiv:0809.5112</a>, <a class="reference external" href="https://doi.org/10.1103/PhysRevD.78.123506">doi:10.1103/PhysRevD.78.123506</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="cosebis" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[14]</a></td><td>P.&nbsp;Schneider, T.&nbsp;Eifler, and E.&nbsp;Krause. COSEBIs: Extracting the full E-/B-mode information from cosmic shear correlation functions. <em>\aap </em>, 520:A116, September 2010. <a class="reference external" href="http://adsabs.harvard.edu/abs/2010A">ads link</a>, <a class="reference external" href="https://arxiv.org/abs/1002.2136">arXiv:1002.2136</a>, <a class="reference external" href="https://doi.org/10.1051/0004-6361/201014235">doi:10.1051/0004-6361/201014235</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="mnras-341-1311s" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[15]</a></td><td>R.&nbsp;E. Smith, J.&nbsp;A. Peacock, A.&nbsp;Jenkins, S.&nbsp;D.&nbsp;M. White, C.&nbsp;S. Frenk, F.&nbsp;R. Pearce, P.&nbsp;A. Thomas, G.&nbsp;Efstathiou, and H.&nbsp;M.&nbsp;P. Couchman. Stable clustering, the halo model and non-linear cosmological power spectra. <em>\mnras </em>, 341:1311–1332, June 2003. <a class="reference external" href="http://cdsads.u-strasbg.fr/cgi-bin/nph-bib_query?bibcode=2003MNRAS.341.1311S&amp;amp;db_key=AST">ads link</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="apj-761-152t" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[16]</a></td><td>R.&nbsp;Takahashi, M.&nbsp;Sato, T.&nbsp;Nishimichi, A.&nbsp;Taruya, and M.&nbsp;Oguri. Revising the Halofit Model for the Nonlinear Matter Power Spectrum. <em>\apj </em>, 761:152, December 2012. <a class="reference external" href="http://cdsads.u-strasbg.fr/abs/2012ApJ...761..152T">ads link</a>, <a class="reference external" href="https://arxiv.org/abs/1208.2701">arXiv:1208.2701</a>, <a class="reference external" href="https://doi.org/10.1088/0004-637X/761/2/152">doi:10.1088/0004-637X/761/2/152</a>.</td></tr>
</tbody>
</table>
</p>
</div>
<div class="section" id="contact">
<h3>Contact<a class="headerlink" href="#contact" title="Permalink to this headline">¶</a></h3>
<p>Feel free to email me at <a class="reference external" href="mailto:martin&#46;kilbinger&#37;&#52;&#48;cea&#46;fr">martin<span>&#46;</span>kilbinger<span>&#64;</span>cea<span>&#46;</span>fr</a></p>
<dl class="docutils">
<dt>Have fun!</dt>
<dd>Martin Kilbinger</dd>
</dl>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">nicaea</a><ul>
<li><a class="reference internal" href="#authors">Authors:</a><ul>
<li><a class="reference internal" href="#contributors">Contributors:</a></li>
<li><a class="reference internal" href="#documentation">Documentation</a></li>
<li><a class="reference internal" href="#download-compile-and-run-nicaea">Download, compile, and run nicaea</a><ul>
<li><a class="reference internal" href="#download-the-code">Download the code</a></li>
<li><a class="reference internal" href="#compile-and-install-the-code">Compile and install the code</a></li>
<li><a class="reference internal" href="#run-the-demo-programs">Run the demo programs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#main-functions">Main functions</a><ul>
<li><a class="reference internal" href="#second-order-shear-statistics">Second-order shear statistics</a></li>
<li><a class="reference internal" href="#third-order-shear-statistics">Third-order shear statistics</a></li>
<li><a class="reference internal" href="#power-spectra">Power spectra</a></li>
<li><a class="reference internal" href="#ranges">Ranges</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cosmology">Cosmology</a><ul>
<li><a class="reference internal" href="#reading-parameters-from-a-file">Reading parameters from a file</a></li>
<li><a class="reference internal" href="#initializing-the-cosmology">Initializing the cosmology</a></li>
<li><a class="reference internal" href="#changing-the-cosmology">Changing the cosmology</a></li>
<li><a class="reference internal" href="#parameters-and-ranges">Parameters and ranges</a></li>
<li><a class="reference internal" href="#id4">Cosmology</a></li>
<li><a class="reference internal" href="#redshift-parameters">Redshift parameters</a><ul>
<li><a class="reference internal" href="#nofz-hist">nofz=hist</a></li>
<li><a class="reference internal" href="#nofz-single">nofz=single</a></li>
</ul>
</li>
<li><a class="reference internal" href="#flags">Flags</a></li>
</ul>
</li>
<li><a class="reference internal" href="#errors-and-diagnostics">Errors and diagnostics</a></li>
<li><a class="reference internal" href="#extrapolation">Extrapolation</a></li>
<li><a class="reference internal" href="#performance">Performance</a></li>
<li><a class="reference internal" href="#known-bugs-and-shortcomings">Known bugs and shortcomings</a></li>
<li><a class="reference internal" href="#changes-compared-to-the-rob-smith-s-original-halofit">Changes compared to the Rob Smith&#8217;s original halofit</a></li>
<li><a class="reference internal" href="#acknowledgements">Acknowledgements</a></li>
<li><a class="reference internal" href="#references">References</a></li>
<li><a class="reference internal" href="#contact">Contact</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">nicaea v2.7 documentation</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/nicaea_2.7.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="index.html" title="nicaea v2.7 documentation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">nicaea  documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Martin Kilbinger.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.
    </div>
  </body>
</html>